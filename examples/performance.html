<html>
  <head>
    <meta charset="UTF-8" />
    <title>spine-pixi</title>
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@latest/dist/pixi.min.js"></script>
    <script src="../dist/spine-pixi.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tweakpane@3.1.9/dist/tweakpane.min.js"></script>
    <link rel="stylesheet" href="./index.css">
  </head>

  <body>
    <script>
      (async function () {
        var app = new PIXI.Application();
        await app.init({
          width: window.innerWidth,
          height: window.innerHeight,
          resolution: window.devicePixelRatio || 1,
          autoDensity: true,
          resizeTo: window,
          backgroundColor: 0x2c3e50,
          hello: true,
        })
        document.body.appendChild(app.view);

        // Pre-load the skeleton data and atlas. You can also load .json skeleton data.
        PIXI.Assets.add({alias: "spineboyData", src: "./assets/spineboy-pro.skel"});
        PIXI.Assets.add({alias: "spineboyAtlas", src: "./assets/spineboy-pma.atlas"});
        await PIXI.Assets.load(["spineboyData", "spineboyAtlas"]);

        for (let i = 0; i < 1000; i++) {
          // Create the spine display object
          const spineboy = spine.Spine.from({skeleton: "spineboyData", atlas: "spineboyAtlas", 
            scale: 0.2,
          });

          // Set the default mix time to use when transitioning
          // from one animation to the next.
          spineboy.state.data.defaultMix = 0.2;

          // Randomly place the spine object within screen.
          spineboy.x = window.innerWidth / 2 + spineboy.getBounds().width / 2 + (Math.random() * 2 - 1) * window.innerWidth / 2;
          spineboy.y = window.innerHeight / 2 + spineboy.getBounds().height / 2 + (Math.random() * 2 - 1) * window.innerHeight / 2;

          // Set animation "run", "idle" or "hoverboard" randomly on track 0, looped.
          if (Math.random() < 0.33)
            spineboy.state.setAnimation(0, "run", true);
          else if (Math.random() < 0.66)
            spineboy.state.setAnimation(0, "idle", true);
          else
            spineboy.state.setAnimation(0, "hoverboard", true);

          // Add the display object to the stage.
          app.stage.addChild(spineboy);
        }
      })();
    </script>
  </body>
</html>